# ============================================================================
# FLASH Bridge Backend - PRODUCTION Environment Configuration
# ============================================================================
# Copy this file to backend/.env and configure ALL required values
# NEVER commit .env to version control!
#
# ⚠️  PRODUCTION MODE: No fallbacks, no simulation, no demo mode
# ⚠️  All marked [REQUIRED] variables MUST be configured
# ============================================================================

# ============================================================================
# SERVER CONFIGURATION
# ============================================================================
PORT=3001
NODE_ENV=production

# [REQUIRED] Frontend URL for CORS
FRONTEND_ORIGIN=https://your-production-domain.com

# [REQUIRED] Admin API key - generate a strong random key
# Generate with: openssl rand -hex 32
ADMIN_API_KEY=YOUR_STRONG_ADMIN_API_KEY_HERE

# Optional: Client API key for additional auth layer
CLIENT_API_KEY=

# ============================================================================
# SOLANA CONFIGURATION
# ============================================================================
# [REQUIRED] Solana Network: devnet, testnet, mainnet-beta
SOLANA_NETWORK=mainnet-beta

# [REQUIRED] Solana RPC URL - use a reliable RPC provider for production
# Recommended: Helius, QuickNode, or Alchemy
SOLANA_RPC_URL=https://your-rpc-provider.com

# [REQUIRED] Flash Bridge MXE Program ID
# This is your deployed flash-bridge-mxe program on Solana
FLASH_BRIDGE_MXE_PROGRAM_ID=YOUR_DEPLOYED_PROGRAM_ID_HERE

# Legacy PROGRAM_ID (optional, FLASH_BRIDGE_MXE_PROGRAM_ID takes precedence)
PROGRAM_ID=

# ============================================================================
# RELAYER CONFIGURATION
# ============================================================================
# Treasury wallet that pays SOL claims
ENABLE_RELAYER=false
ENABLE_BTC_RELAYER=false

# Path to your Solana keypair file for the treasury/relayer wallet
# RELAYER_KEYPAIR_PATH=./relayer-keypair-new.json

# ============================================================================
# ARCIUM MPC CONFIGURATION - PRODUCTION (NO SIMULATION)
# ============================================================================
# ⚠️  PRODUCTION MODE: Simulation is DISABLED - Real MPC required
# These settings are enforced by the backend and cannot be overridden:
#   ENABLE_ARCIUM_MPC=true (always)
#   ARCIUM_SIMULATED=false (always)
#   ARCIUM_USE_REAL_SDK=true (always)

# [REQUIRED] Arcium Node Endpoint - Your running Arcium node
ARCIUM_ENDPOINT=http://your-arcium-node:8080

# [REQUIRED] Arcium Network
ARCIUM_NETWORK=mainnet

# [REQUIRED] Arcium Cluster ID (from your node registration)
ARCIUM_CLUSTER_ID=your_cluster_id_here

# [REQUIRED] Arcium Node Offset (from your node registration)
ARCIUM_NODE_OFFSET=your_node_offset_here

# Arcium API Key (if required by your cluster)
ARCIUM_API_KEY=your_api_key_here

# Arcium MXE Configuration
ARCIUM_MXE_ID=flash_bridge_privacy

# Performance tuning (optional)
ARCIUM_COMPUTATION_TIMEOUT=30000
ARCIUM_MAX_RETRIES=3
ARCIUM_CACHE_TTL=300000
ARCIUM_MAX_POOL_SIZE=10
ARCIUM_PRIVACY_LEVEL=full

# ============================================================================
# DATABASE CONFIGURATION - PRODUCTION (PostgreSQL Required)
# ============================================================================
# [REQUIRED] PostgreSQL is REQUIRED for production - SQLite not supported

# [REQUIRED] Database host
DB_HOST=your-postgres-host.com

# Database port (default: 5432)
DB_PORT=5432

# [REQUIRED] Database name
DB_NAME=flash_bridge

# [REQUIRED] Database user
DB_USER=flash_bridge_user

# [REQUIRED] Database password - use a strong password
DB_PASSWORD=YOUR_STRONG_DATABASE_PASSWORD_HERE

# Connection pool settings (tune based on your load)
DB_POOL_MAX=20
DB_POOL_MIN=5
DB_IDLE_TIMEOUT=30000
DB_CONNECTION_TIMEOUT=10000

# ============================================================================
# REDIS CONFIGURATION - PRODUCTION (Distributed Rate Limiting)
# ============================================================================
# [RECOMMENDED] Redis enables distributed rate limiting across instances
# Without Redis, rate limiting uses in-memory storage (single-instance only)

# Redis URL (preferred format)
REDIS_URL=redis://your-redis-host:6379

# Or separate host/port configuration
REDIS_HOST=your-redis-host
REDIS_PORT=6379
REDIS_PASSWORD=your_redis_password

# ============================================================================
# BITCOIN CONFIGURATION - PRODUCTION
# ============================================================================
# [REQUIRED] Bitcoin Network: mainnet or testnet
BITCOIN_NETWORK=mainnet

# Bitcoin Explorer API (defaults based on network if not set)
BITCOIN_EXPLORER_URL=https://blockstream.info/api

# [REQUIRED] Bitcoin Bridge Address - your controlled address for receiving deposits
BITCOIN_BRIDGE_ADDRESS=bc1q_YOUR_MAINNET_ADDRESS_HERE

# [REQUIRED for unique addresses] Extended Public Key for HD address derivation
BITCOIN_BRIDGE_XPUB=xpub_YOUR_EXTENDED_PUBLIC_KEY_HERE

# Address derivation settings
BITCOIN_DEPOSIT_DERIVATION_PATH="m/84'/0'/0'"
BITCOIN_DEPOSIT_CHANGE_INDEX=0
BITCOIN_DEPOSIT_TTL_MINUTES=180

# [PRODUCTION] Minimum 1 confirmation required, recommend 3+ for large amounts
BITCOIN_REQUIRED_CONFIRMATIONS=3

# Bootstrap reserve (BTC amount to seed the bridge)
BOOTSTRAP_BTC=0

# [REQUIRED for production] Enable Bitcoin monitoring
ENABLE_BITCOIN_MONITORING=true

# ============================================================================
# JUPITER SWAP CONFIGURATION
# ============================================================================
# Jupiter API for token swaps
# JUPITER_API_URL=https://quote-api.jup.ag/v6
# JUPITER_MIN_DELAY_MS=500
# JUPITER_MAX_DELAY_MS=2000

# ============================================================================
# FEATURE FLAGS
# ============================================================================
ENABLE_ZENZEC=false  # legacy flag retained for compatibility

# ============================================================================
# RESERVE MANAGER CONFIGURATION
# ============================================================================
# Reserve cache settings for performance optimization
RESERVE_CACHE_TTL=30000                    # Cache TTL in milliseconds (30 seconds)
RESERVE_MAX_CACHE_SIZE=100                 # Maximum cache entries to prevent memory leaks
RESERVE_CLEANUP_INTERVAL=300000            # Cache cleanup interval in milliseconds (5 minutes)

# ============================================================================
# BTC RELAYER CONFIGURATION
# ============================================================================
# BTC Relayer memory management and performance settings
BTC_RELAYER_MAX_PENDING=1000               # Maximum pending items before cleanup
BTC_RELAYER_MAX_EVENTS=10000               # Maximum processed events in cache
BTC_RELAYER_EVENT_TTL=86400000             # Event TTL in milliseconds (24 hours)

# ============================================================================
# DATABASE CONFIGURATION (EXTENDED)
# ============================================================================
# Database maintenance and cleanup settings
DB_TRANSACTION_CLEANUP_INTERVAL_MINUTES=10  # How often to clean up stuck transactions

# ============================================================================
# LOGGING & DEBUGGING
# ============================================================================
# LOG_LEVEL=info
# DEBUG=false

# ============================================================================
# SECURITY NOTES
# ============================================================================
# 1. Never commit this file with real values
# 2. Use different keys for testnet vs mainnet
# 3. Store sensitive keys in secure key management (HSM/KMS) for production
# 4. Rotate keys regularly
# 5. Use strong passwords for database
# 6. Enable rate limiting in production

